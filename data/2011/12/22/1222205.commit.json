{
  "when": "2011-12-22T07:44:43-05:00", 
  "message": "More documentation updates", 
  "who": "hiranya", 
  "changes": [
    {
      "chunks": [
        {
          "locn": "-7,6 +7,34", 
          "lines": [
            "             <ul>\n", 
            "                 <li><a href=\"#Intro\">Introduction</a></li>\n", 
            "                 <li><a href=\"#Categories\">Mediator Categories</a></li>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#CoreMediators\">Core Mediators</a>\n", 
            "+                    <ul>\n", 
            "+                        <li><a href=\"#Drop\">Drop Mediator</a></li>\n", 
            "+                        <li><a href=\"#Log\">Log Mediator</a></li>\n", 
            "+                        <li><a href=\"#Property\">Property Mediator</a></li>\n", 
            "+                        <li><a href=\"#Send\">Send Mediator</a></li>\n", 
            "+                    </ul>\n", 
            "+                </li>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#FilterMediators\">Filter Mediators</a>\n", 
            "+                    <ul>\n", 
            "+                        <li><a href=\"#Filter\">Filter Mediator</a></li>\n", 
            "+                        <li><a href=\"#InOut\">In/Out Mediator</a></li>\n", 
            "+                        <li><a href=\"#Switch\">Switch Mediator</a></li>\n", 
            "+                    </ul>\n", 
            "+                </li>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#FilterMediators\">Transformation Mediators</a>\n", 
            "+                    <ul>\n", 
            "+                        <li><a href=\"#XSLT\">XSLT Mediator</a></li>\n", 
            "+                        <li><a href=\"#XQuery\">XQuery Mediator</a></li>\n", 
            "+                        <li><a href=\"#MakeFault\">MakeFault Mediator</a></li>\n", 
            "+                        <li><a href=\"#Header\">Header Mediator</a></li>\n", 
            "+                        <li><a href=\"#URLRewrite\">URL Rewrite Mediator</a></li>\n", 
            "+                        <li><a href=\"#PayloadFactory\">Payload Factory Mediator</a></li>\n", 
            "+                    </ul>\n", 
            "+                </li>\n", 
            "             </ul>\n", 
            "         </section>\n", 
            "         <section name=\"Introduction\" id=\"Intro\">\n"
          ]
        }, 
        {
          "locn": "-244,5 +272,302", 
          "lines": [
            "                 </p>\n", 
            "             </subsection>\n", 
            "         </section>\n", 
            "+        <section name=\"Filter Mediators\" id=\"Filter Mediators\">\n", 
            "+            <subsection name=\"Filter Mediator\" id=\"Filter\">\n", 
            "+                <p>\n", 
            "+                    Filter mediator adds 'if-else' like semantics to the Synapse configuration language.\n", 
            "+                    It can be used to evaluate a condition on a message and take some action\n", 
            "+                    based on the outcome. The configuration of the filter mediator takes the\n", 
            "+                    following form.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;filter (source=\"xpath\" regex=\"string\") | xpath=\"xpath\"&gt;\n", 
            "+    mediator+\n", 
            "+&lt;/filter&gt;</div>\n", 
            "+                <p>\n", 
            "+                    The filter mediator either tests the given XPath expression as a boolean\n", 
            "+                    expression, or matches the result of the source XPath expression as a string\n", 
            "+                    against the given regular expression. If the condition evaluates to true, the\n", 
            "+                    filter mediator will execute the enclosed child mediators.\n", 
            "+                </p>\n", 
            "+                <p>\n", 
            "+                    Alternatively one can use the following syntax to configure the filter mediator.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;filter (source=\"xpath\" regex=\"string\") | xpath=\"xpath\"&gt;\n", 
            "+    &lt;then [sequence=\"string\"]&gt;\n", 
            "+        mediator+\n", 
            "+    &lt;/then&gt;\n", 
            "+    &lt;else [sequence=\"string\"]&gt;\n", 
            "+        mediator+\n", 
            "+    &lt;/else&gt;\n", 
            "+&lt;/filter&gt;</div>\n", 
            "+                <p>\n", 
            "+                    In this case too the filter condition is evaluated in the same manner as\n", 
            "+                    described above. Messages for which the condition evaluates to true will be\n", 
            "+                    mediated through the mediators enclosed by the 'then' element. Failed messages\n", 
            "+                    will be mediated through the mediators enclosed by the 'else' element.\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"In/Out Mediators\" id=\"InOut\">\n", 
            "+                <p>\n", 
            "+                    In mediator and Out mediator are used to filter out traffic based on the\n", 
            "+                    direction of the messages. As their names imply, In mediator processes only\n", 
            "+                    the requests (in messages) while ignoring the responses (out messages). The\n", 
            "+                    out mediator does the exact opposite by processing only the responses while\n", 
            "+                    ignoring the requests. In many occasions these two mediators are deployed\n", 
            "+                    together to create separate flows for requests and responses. The syntax\n", 
            "+                    outline for the two mediators is given below.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;in&gt;\n", 
            "+    mediator+\n", 
            "+&lt;/in&gt;\n", 
            "+\n", 
            "+&lt;out&gt;\n", 
            "+    mediator+\n", 
            "+&lt;/out&gt;</div>\n", 
            "+                <p>\n", 
            "+                    In mediator will process requests through the child mediators anf the Out\n", 
            "+                    mediator will process responses through the child mediators.\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"Switch Mediator\" id=\"Switch\">\n", 
            "+                <p>\n", 
            "+                    Switch mediator provides switch-case semantics in the Synapse configuration\n", 
            "+                    language.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;switch source=\"xpath\"&gt;\n", 
            "+    &lt;case regex=\"string\"&gt;\n", 
            "+        mediator+\n", 
            "+    &lt;/case&gt;+\n", 
            "+    &lt;default&gt;\n", 
            "+        mediator+\n", 
            "+    &lt;/default&gt;?\n", 
            "+&lt;/switch&gt;</div>\n", 
            "+                <p>\n", 
            "+                    The source XPath is executed on the messages. The resulting value is then\n", 
            "+                    tested against the regular expressions defined in each 'case' element. When\n", 
            "+                    a matching case is found the message will be mediated through its child\n", 
            "+                    mediators. If none of the cases match, the message will handed to the 'default'\n", 
            "+                    case (if available).\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "+        </section>\n", 
            "+        <section name=\"Transformation Mediators\" id=\"TransformationMediators\">\n", 
            "+            <subsection name=\"XSLT Mediator\" id=\"XSLT\">\n", 
            "+                <p>\n", 
            "+                    XSLT mediator applies the specified XSLT transformation to the selected\n", 
            "+                    element of the current message payload. 'source' attribute selects the source\n", 
            "+                    element to apply the transformation on. Where not specified, it defaults to the\n", 
            "+                    first child of the SOAP body. Output of the transformation replaces the source\n", 
            "+                    element when 'target' attribute is not specified. Otherwise, the output is\n", 
            "+                    stored in the property specified by the 'target' attribute.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;xslt key=\"string\" [source=\"xpath\"] [target=\"string\"]&gt;\n", 
            "+    &lt;property name=\"string\" (value=\"literal\" | expression=\"xpath\")/&gt;*\n", 
            "+    &lt;feature name=\"string\" value=\"true | false\" /&gt;*\n", 
            "+    &lt;attribute name=\"string\" value=\"string\" /&gt;*\n", 
            "+    &lt;resource location=\"...\" key=\"...\"/&gt;*\n", 
            "+&lt;/xslt&gt;</div>\n", 
            "+                <p>\n", 
            "+                    If the output method specified by the stylesheet is text (i.e. the stylesheet\n", 
            "+                    has the <tt>&lt;xsl:output method=\"text\"/&gt;</tt> directive),\n", 
            "+                    then the output of the transformation is wrapped in an element with name\n", 
            "+                    <tt>{http://ws.apache.org/commons/ns/payload}text</tt>. Note that when an\n", 
            "+                    element with this name is present as the first child of the SOAP body of an\n", 
            "+                    outgoing message, JMS and VFS transports automatically unwrap the\n", 
            "+                    content and send it out as plain text. XSLT mediator can therefore be used for\n", 
            "+                    integration with systems relying on plain text messages.\n", 
            "+                </p>\n", 
            "+                <p>\n", 
            "+                    Usage of sub-elements of XSLT mediator configuration is as follows:\n", 
            "+                </p>\n", 
            "+                <ul>\n", 
            "+                    <li>\n", 
            "+                        property - Stylesheet parameters can be passed into the transformations\n", 
            "+                        using 'property' elements.\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        feature - Defines any features which should be explicitly set to the\n", 
            "+                        TransformerFactory. For example,\n", 
            "+                        <tt>'http://ws.apache.org/ns/synapse/transform/feature/dom'</tt> feature\n", 
            "+                        enables DOM based transformations instead of serializing elements into byte\n", 
            "+                        streams and/or temporary files. Although enabling this feature could improve\n", 
            "+                        performance of the transformation, it might not work for all transformations.\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        attribute - Defines attributes which should be explicitly set on the\n", 
            "+                        TransformerFactory.\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        resource - Can be used to resolve XSLT imports and includes from the\n", 
            "+                        repository. It works in exactly the same way as the corresponding element in\n", 
            "+                        a &lt;proxy&gt; definition.\n", 
            "+                    </li>\n", 
            "+                </ul>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"XQuery Mediator\" id=\"XQuery\">\n", 
            "+                <p>\n", 
            "+                    The XQuery mediator can be used to perform an XQuery transformation. 'key'\n", 
            "+                    attribute specifies the XQuery transformation, and the optional 'target'\n", 
            "+                    attribute specifies the node of the message that should be transformed.\n", 
            "+                    This defaults to the first child of the SOAP body of the payload. 'variable'\n", 
            "+                    element defines a variable that could be bound to the dynamic context of the\n", 
            "+                    XQuery engine in order to access those variables through the XQuery script.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;xquery key=\"string\" [target=\"xpath\"]&gt;\n", 
            "+    &lt;variable name=\"string\" type=\"string\" [key=\"string\"] [expression=\"xpath\"] [value=\"string\"]/&gt;?\n", 
            "+&lt;/xquery&gt;</div>\n", 
            "+                <p>\n", 
            "+                    It is possible to specify just a literal 'value', or an XPath expression\n", 
            "+                    over the payload, or even specify a registry key or a registry key\n", 
            "+                    combined with an XPath expression that selects the variable. The name of\n", 
            "+                    the variable corresponds to the name of variable declaration in the XQuery\n", 
            "+                    script. The 'type' of the variable must be a valid type defined by the\n", 
            "+                    JSR-000225 (XQJ API).\n", 
            "+                </p>\n", 
            "+                <p>\n", 
            "+                    The supported types are:\n", 
            "+                </p>\n", 
            "+                <ul>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_INT -&gt; INT\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_INTEGER -&gt; INTEGER\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_BOOLEAN -&gt; BOOLEAN\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_BYTE - &gt; BYTE\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_DOUBLE -&gt; DOUBLE\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_SHORT -&gt; SHORT\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_LONG -&gt; LONG\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_FLOAT -&gt; FLOAT\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQBASETYPE_STRING -&gt; STRING\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQITEMKIND_DOCUMENT -&gt; DOCUMENT\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQITEMKIND_DOCUMENT_ELEMENT -&gt; DOCUMENT_ELEMENT\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        XQItemType.XQITEMKIND_ELEMENT -&gt; ELEMENT\n", 
            "+                    </li>\n", 
            "+                </ul>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"MakeFault Mediator\" id=\"MakeFault\">\n", 
            "+                <p>\n", 
            "+                    MakeFault mediator mediator transforms the current message into a fault message.\n", 
            "+                    It should be noted that makeFault mediator does NOT send the message after\n", 
            "+                    transforming it. A &lt;send&gt; mediator needs to be invoked separately to send\n", 
            "+                    a fault message created by this mediator.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;makefault [version=\"soap11|soap12|pox\"] [response=\"true|false\"]&gt;\n", 
            "+    &lt;code (value=\"literal\" | expression=\"xpath\")/&gt;\n", 
            "+    &lt;reason (value=\"literal\" | expression=\"xpath\")/&gt;\n", 
            "+    &lt;node&gt;...&lt;/node&gt;?\n", 
            "+    &lt;role&gt;...&lt;/role&gt;?\n", 
            "+   (&lt;detail expression=\"xpath\"/&gt; | &lt;detail&gt;...&lt;/detail&gt;)?\n", 
            "+&lt;/makefault&gt;</div>\n", 
            "+                <p>\n", 
            "+                    The fault message \"To\" header is set to the \"Fault-To\" of the original message\n", 
            "+                    if such a header exists on the original message. Depending on the 'version'\n", 
            "+                    attribute, the fault message is created as a SOAP 1.1, SOAP 1.2\n", 
            "+                    or POX fault. If the optional response attribute value is set as 'true',\n", 
            "+                    makefault mediator marks the message as a response. Optional &lt;node&gt;,\n", 
            "+                    &lt;role&gt; and &lt;detail&gt; subelements in the mediator configuration can\n", 
            "+                    be used to set the corresponding elements in the resulting SOAP fault.\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"Header Mediator\" id=\"Header\">\n", 
            "+                <p>\n", 
            "+                    Header mediator sets or removes a specified header from the current SOAP\n", 
            "+                    infoset. The optional 'action' attribute specifies whether the mediator should\n", 
            "+                    set or remove the header. If omitted, it defaults to set action.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;header name=\"qname\" (value=\"literal\" | expression=\"xpath\") [action=\"set\"]/&gt;\n", 
            "+&lt;header name=\"qname\" action=\"remove\"/&gt;</div>\n", 
            "+                <p>\n", 
            "+                    The value of the 'name' attribute must be one of the following aliases or\n", 
            "+                    a valid QName with a namespace prefix. In the latter case the namespace prefix\n", 
            "+                    must be mapped to a valid namespace URI using the standard xmlns attribute.\n", 
            "+                </p>\n", 
            "+                <ul>\n", 
            "+                    <li>To</li>\n", 
            "+                    <li>From</li>\n", 
            "+                    <li>Action</li>\n", 
            "+                    <li>FaultTo</li>\n", 
            "+                    <li>ReplyTo</li>\n", 
            "+                    <li>RelatesTo</li>\n", 
            "+                </ul>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"URL Rewrite Mediator\" id=\"URLRewrite\">\n", 
            "+                <p>\n", 
            "+                    URL Rewrite mediator can be used to modify and transform the URL values\n", 
            "+                    available in the message. By default, this mediator takes the 'To' header of the\n", 
            "+                    message and apples the provided rewrite rules on it. Alternatively, one can\n", 
            "+                    specify a property name in the 'inProperty' attribute, in which case the\n", 
            "+                    mediator takes the value of the specified property as the input URL.\n", 
            "+                </p>\n", 
            "+                <p>\n", 
            "+                    Similarly the mediator by default sets the transformed URL as the 'To' header of\n", 
            "+                    the message and alternatively you can use the 'outProperty' attribute to\n", 
            "+                    instruct the mediator to set the resulting URL as a property.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;rewrite [inProperty=\"string\"] [outProperty=\"string\"]&gt;\n", 
            "+    &lt;rewriterule&gt;\n", 
            "+        &lt;condition&gt;\n", 
            "+        ...\n", 
            "+        &lt;/condition&gt;?\n", 
            "+        &lt;action [type=\"append|prepend|replace|remove|set\"] [value=\"string\"]\n", 
            "+          [xpath=\"xpath\"] [fragment=\"protocol|host|port|path|query|ref|user|full\"] [regex=\"regex\"]&gt;+\n", 
            "+    &lt;/rewriterule&gt;+\n", 
            "+&lt;/rewrite&gt;</div>\n", 
            "+                <p>\n", 
            "+                    The mediator applies URL transformations by evaluating a set of rules on\n", 
            "+                    the message. Rules are specified using the 'rewriterule' element. Rules are\n", 
            "+                    evaluated in the order in which they are specified. A rule can consist of an\n", 
            "+                    optional condition and one or more rewrite actions. If the condition is provided,\n", 
            "+                    it is evaluated first and specified rewrite actions are executed only if the\n", 
            "+                    condition evaluates to true. If no condition is specified, the provided rewrite\n", 
            "+                    actions will be always executed. The condition should be wrapped in a 'condition'\n", 
            "+                    element within the 'rewriterule' element. Rewrite actions are specified using\n", 
            "+                    'action' elements.\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "+            <subsection name=\"Payload Factory Mediator\" id=\"PayloadFactory\">\n", 
            "+                <p>\n", 
            "+                    Payload-factory mediator creates a new SOAP payload for the message, replacing\n", 
            "+                    the existing one. <tt>printf()</tt> style formatting is used to configure the\n", 
            "+                    transformation performed by this mediator.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;payloadFactory&gt;\n", 
            "+    &lt;format&gt;&quot;xmlstring&quot;&lt;/format&gt;\n", 
            "+    &lt;args&gt;\n", 
            "+        &lt;arg (value=&quot;literal&quot; | expression=&quot;xpath&quot;)/&gt;*\n", 
            "+    &lt;/args&gt;\n", 
            "+&lt;/payloadFactory&gt;</div>\n", 
            "+\n", 
            "+                <p>\n", 
            "+                    'format' sub-element of the mediator configuration specifies the format of the\n", 
            "+                    new payload. All $n occurrences in the format will be replaced by the value of\n", 
            "+                    the n th argument at runtime. Each argument in the mediator configuration could\n", 
            "+                    be a static value or an XPath expression. When an expression is used, value is\n", 
            "+                    fetched at runtime by evaluating the provided XPath expression against the\n", 
            "+                    existing SOAP message/message context.\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "+        </section>\n", 
            "     </body>\n", 
            " </document>\n", 
            "\\ No newline at end of file\n"
          ]
        }
      ], 
      "to": "scratch/hiranya/website/src/site/xdoc/userguide/mediators.xml", 
      "from": "scratch/hiranya/website/src/site/xdoc/userguide/mediators.xml"
    }
  ], 
  "id": "1222205"
}