{
  "when": "2013-08-17T13:56:42-04:00", 
  "message": "Adding documentation on vfs transport", 
  "who": "hiranya", 
  "changes": [
    {
      "chunks": [
        {
          "locn": "-0,0 +1,298", 
          "lines": [
            "+<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n", 
            "+\n", 
            "+<!--\n", 
            "+  ~  Licensed to the Apache Software Foundation (ASF) under one\n", 
            "+  ~  or more contributor license agreements.  See the NOTICE file\n", 
            "+  ~  distributed with this work for additional information\n", 
            "+  ~  regarding copyright ownership.  The ASF licenses this file\n", 
            "+  ~  to you under the Apache License, Version 2.0 (the\n", 
            "+  ~  \"License\"); you may not use this file except in compliance\n", 
            "+  ~  with the License.  You may obtain a copy of the License at\n", 
            "+  ~\n", 
            "+  ~   http://www.apache.org/licenses/LICENSE-2.0\n", 
            "+  ~\n", 
            "+  ~  Unless required by applicable law or agreed to in writing,\n", 
            "+  ~  software distributed under the License is distributed on an\n", 
            "+  ~   * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n", 
            "+  ~  KIND, either express or implied.  See the License for the\n", 
            "+  ~  specific language governing permissions and limitations\n", 
            "+  ~  under the License.\n", 
            "+  -->\n", 
            "+\n", 
            "+<document>\n", 
            "+    <properties>\n", 
            "+        <title>Apache Synapse - File Transport</title>\n", 
            "+    </properties>\n", 
            "+    <body>\n", 
            "+        <section name=\"File Transport\" id=\"Contents\">\n", 
            "+            <ul>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#Introduction\">Introduction</a>\n", 
            "+                </li>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#Configuration\">Transport Configuration</a>\n", 
            "+                    <ul>\n", 
            "+                        <li><a href=\"#Listener\">File Transport Listener (VFS Listener)</a></li>\n", 
            "+                    </ul>\n", 
            "+                </li>\n", 
            "+            </ul>\n", 
            "+        </section>\n", 
            "+        <section name=\"Introduction\" id=\"Introduction\">\n", 
            "+            <p>\n", 
            "+                The file transport, also known as the VFS (Virtual File System) transport, can be\n", 
            "+                used to read, mediate and write file content using Synapse. This transport allows\n", 
            "+                Synapse to interface with the local file system and remote file systems via\n", 
            "+                file transfer protocols such as FTP.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                The file transport is based on <a href=\"http://commons.apache.org/proper/commons-vfs/\">Apache Commons VFS</a>,\n", 
            "+                and supports all the file transfer protocols supported by Commons VFS. This includes\n", 
            "+                interactions with the local file system, HTTP, HTTPS, FTP and SFTP (i.e. file transfer\n", 
            "+                over SSH).\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                There is a fundamental difference between the file transport and transports such as\n", 
            "+                HTTP, and it is important to understand this difference to be able to use the file\n", 
            "+                transport correctly. The HTTP transport binds to a single protocol endpoint, i.e. a\n", 
            "+                TCP port on which it accepts incoming HTTP requests. These requests are then\n", 
            "+                dispatched to the appropriate service based on the request URI. On the other hand,\n", 
            "+                the file transport only receives the payload of a message (i.e. the file), but no\n", 
            "+                additional information that could be used to dispatch the message to a service. This\n", 
            "+                means that file system locations must be explicitly mapped to services. This is done\n", 
            "+                using a set of service parameters. For Synapse this means that the VFS transport\n", 
            "+                listener can only be used in conjunction with proxy services. The relevant service\n", 
            "+                parameters are specified in the proxy service configuration as follows:\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;proxy name=&quot;MyVFSService&quot; transports=&quot;vfs&quot;&gt;\n", 
            "+    &lt;parameter name=&quot;transport.vfs.FileURI&quot;&gt;file:///var/spool/synapse/in&lt;/parameter&gt;\n", 
            "+    &lt;parameter name=&quot;transport.vfs.ContentType&quot;&gt;application/xml&lt;/parameter&gt;\n", 
            "+    ...\n", 
            "+    &lt;target&gt;\n", 
            "+    ...\n", 
            "+    &lt;/target&gt;\n", 
            "+&lt;/proxy&gt;</div>\n", 
            "+            <p>\n", 
            "+                In the above example the file system location file:///var/spool/synapse/in is\n", 
            "+                explicitly bound to MyVFSService. Any file dropped in that location will be\n", 
            "+                pre-dispatched to MyVFSService, bypassing any other configured dispatch mechanisms\n", 
            "+                that would normally apply to messages received via HTTP.\n", 
            "+            </p>\n", 
            "+            <p><a href=\"#Contents\">[Back to top]</a></p>\n", 
            "+        </section>\n", 
            "+        <section name=\"Transport Configuration\" id=\"Configuration\">\n", 
            "+            <p>\n", 
            "+                The file transport consists of a transport listener component and a transport sender\n", 
            "+                component. Proxy services can read files using the file transport listener, and they\n", 
            "+                can write file content using the file transport sender. Following sections describe\n", 
            "+                how to configure these two components of the transport.\n", 
            "+            </p>\n", 
            "+            <subsection name=\"File Transport Listener (VFS Listener)\" id=\"Listener\">\n", 
            "+                <p>\n", 
            "+                    Before a proxy service can read files, the VFS listener must be enabled in the\n", 
            "+                    <string>SYNAPSE_HOME/repository/conf/axis2.xml</string> file of Synapse. Look\n", 
            "+                    for the following XML configuration in the axis2.xml file, and uncomment it if\n", 
            "+                    it's commented out.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;transportReceiver name=\"vfs\" class=\"org.apache.synapse.transport.vfs.VFSTransportListener\"/&gt;</div>\n", 
            "+                <p>\n", 
            "+                    To configure a proxy service to receive messages via the VFS listener (i.e. read\n", 
            "+                    files from some local or remote location), set the \"transports\" attribute on the\n", 
            "+                    proxy service element to \"vfs\":\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;proxy name=&quot;MyVFSService&quot; transports=&quot;vfs&quot;&gt;\n", 
            "+    ...\n", 
            "+&lt;/proxy&gt;</div>\n", 
            "+                <p>\n", 
            "+                    It's also possible to expose a proxy service on VFS transport and several other\n", 
            "+                    transports. Simply specify the required transports as a space-separated list in\n", 
            "+                    the \"transports\" attribute:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;proxy name=&quot;MyVFSService&quot; transports=&quot;vfs http https&quot;&gt;\n", 
            "+    ...\n", 
            "+&lt;/proxy&gt;</div>\n", 
            "+                <p>\n", 
            "+                    A proxy service configured with the VFS listener, can be further customized by\n", 
            "+                    setting a number of parameters (some of which are required). Following table\n", 
            "+                    lists all the supported service parameters.\n", 
            "+                </p>\n", 
            "+                <table>\n", 
            "+                    <tr>\n", 
            "+                        <th>Parameter Name</th>\n", 
            "+                        <th>Description/Example</th>\n", 
            "+                        <th>Required</th>\n", 
            "+                        <th>Default</th>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.FileURI</td>\n", 
            "+                        <td>\n", 
            "+                            The primary location to read the file contents from. This must be\n", 
            "+                            specified as a valid URI and it may point to a file or a directory. If\n", 
            "+                            a directory location is specified, the transport will attempt to read\n", 
            "+                            any file dropped into the directory.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FileURI\"&gt;file:///home/user/test/in&lt;/parameter&gt;</div>\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FileURI\"&gt;sftp://bob:password@ftp.example.org/test/in&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>Yes</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.ContentType</td>\n", 
            "+                        <td>\n", 
            "+                            The expected content type for files retrieved for this service. The VFS\n", 
            "+                            transport uses this information to select the appropriate message builder.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ContentType\"&gt;text/xml&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>Yes</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.FileNamePattern</td>\n", 
            "+                        <td>\n", 
            "+                            A file name regex pattern to match when fetching files from a directory\n", 
            "+                            specified by the FileURI.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FileNamePattern\"&gt;.*.xml&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.PollInterval</td>\n", 
            "+                        <td>\n", 
            "+                            The polling interval in seconds.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.PollInterval\"&gt;10&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>300</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.ActionAfterProcess</td>\n", 
            "+                        <td>\n", 
            "+                            Once a file has been read and successfully processed by Synapse (i.e.\n", 
            "+                            without any errors and runtime exceptions), the file should be\n", 
            "+                            either moved or deleted to prevent Synapse from processing the file for\n", 
            "+                            a second time. This parameter specifies which of the above actions\n", 
            "+                            should be taken. Allowed values are MOVE or DELETE.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ActionAfterProcess\"&gt;MOVE&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>DELETE</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.MoveAfterProcess</td>\n", 
            "+                        <td>\n", 
            "+                            Specify the location to which the files should be moved after successfully\n", 
            "+                            processing them. Required if transport.vfs.ActionAfterProcess is set to\n", 
            "+                            MOVE. Ignored otherwise. Value must be a valid URI (local or remote).\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveAfterProcess\"&gt;file:///home/user/test/original&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.ActionAfterFailures</td>\n", 
            "+                        <td>\n", 
            "+                            If Synapse encounters an error while processing a file, the file should be\n", 
            "+                            either moved or deleted to prevent Synapse from processing the file for\n", 
            "+                            a second time. This parameter specifies which of the above actions\n", 
            "+                            should be taken. Allowed values are MOVE or DELETE.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ActionAfterFailure\"&gt;MOVE&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>DELETE</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.MoveAfterFailure</td>\n", 
            "+                        <td>\n", 
            "+                            Specify the location to which the files should be moved after a failure. R\n", 
            "+                            equired if transport.vfs.ActionAfterFailure is set to\n", 
            "+                            MOVE. Ignored otherwise. Value must be a valid URI (local or remote).\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveAfterFailure\"&gt;file:///home/user/test/error&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.ReplyFileURI</td>\n", 
            "+                        <td>\n", 
            "+                            Specify the reply file location as a URI, in case the proxy service\n", 
            "+                            should generate a response message (file) after processing an input file.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ReplyFileURI\"&gt;file:///home/user/test/out&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.ReplyFileName</td>\n", 
            "+                        <td>\n", 
            "+                            Name of the response file that should be generated by the proxy service.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ReplyFileName\"&gt;file:///home/user/test/out&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>response.xml or response.dat depending on the content type of the response</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.MoveTimestampFormat</td>\n", 
            "+                        <td>\n", 
            "+                            Must be a timestamp format string compatible with\n", 
            "+                            <a href=\"http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html\">java.text.SimpleDateFormat</a>.\n", 
            "+                            If specified, Synapse will append a timestamp in the specified format to\n", 
            "+                            all the file names, whenever a file is moved to a new location (i.e. when\n", 
            "+                            moving a file after processing it or after a failure).\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveTimestampFormat\"&gt;yy-MM-dd:HHmmss&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>N/A</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.Locking</td>\n", 
            "+                        <td>\n", 
            "+                            File locking makes sure that each file is accessed by only one proxy\n", 
            "+                            service at any given instant. This is important when multiple proxy\n", 
            "+                            services are reading files from the same location or when one proxy service\n", 
            "+                            is configured to read the files written by another proxy service.\n", 
            "+                            By default file locking is globally enabled in the VFS transport, and\n", 
            "+                            this parameter lets you configure the locking behavior on a per service\n", 
            "+                            basis. Possible values are enable or disable, and both these values are\n", 
            "+                            important because locking can be disabled at the global level by\n", 
            "+                            specifying that at the transport receiver configuration (in axis2.xml) and\n", 
            "+                            selectively enable locking only for a set of services. To configure\n", 
            "+                            global locking behavior, set this parameter in the axis2.xml under the\n", 
            "+                            VFS transport receiver configuration.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.Locking\"&gt;disable&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>enable</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.Streaming</td>\n", 
            "+                        <td>\n", 
            "+                            If this parameter is set to true, the transport will attempt to use a\n", 
            "+                            javax.activation.DataSource (instead of a java.io.InputStream ) object\n", 
            "+                            to pass the content of the file to the message builder. Note that this\n", 
            "+                            is only supported by some message builders, e.g. for plain text and binary.\n", 
            "+                            This allows processing of the message without storing the entire content in memory.\n", 
            "+                            It also has two other side effects:\n", 
            "+                            <ul>\n", 
            "+                                <li>\n", 
            "+                                    The incoming file (or connection in case of a remote file)\n", 
            "+                                    will only be opened on demand.\n", 
            "+                                </li>\n", 
            "+                                <li>\n", 
            "+                                    Since the data is not cached, the file might be read several\n", 
            "+                                    times.\n", 
            "+                                </li>\n", 
            "+                            </ul>\n", 
            "+                            This option can be used to achieve streaming of large payloads. Note\n", 
            "+                            that this feature is still somewhat experimental and might be superseded\n", 
            "+                            by a more flexible mechanism in a future release.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.Streaming\"&gt;true&lt;/parameter&gt;</div>\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>false</td>\n", 
            "+                    </tr>\n", 
            "+                </table>\n", 
            "+                <p><a href=\"#Contents\">[Back to top]</a></p>\n", 
            "+            </subsection>\n", 
            "+        </section>\n", 
            "+    </body>\n", 
            "+</document>\n", 
            "\\ No newline at end of file\n"
          ]
        }
      ], 
      "to": "java/modules/documentation/src/site/xdoc/userguide/transports/vfs.xml", 
      "from": "java/modules/documentation/src/site/xdoc/userguide/transports/vfs.xml"
    }
  ], 
  "id": "1515024"
}