{
  "when": "2013-08-17T14:38:33-04:00", 
  "message": "Updated vfs transport docs", 
  "who": "hiranya", 
  "changes": [
    {
      "chunks": [
        {
          "locn": "-33,8 +33,15", 
          "lines": [
            "                     <a href=\"#Configuration\">Transport Configuration</a>\n", 
            "                     <ul>\n", 
            "                         <li><a href=\"#Listener\">File Transport Listener (VFS Listener)</a></li>\n", 
            "+                        <li><a href=\"#Sender\">File Transport Sender (VFS Sender)</a></li>\n", 
            "                     </ul>\n", 
            "                 </li>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#SFTP\">Using SFTP</a>\n", 
            "+                </li>\n", 
            "+                <li>\n", 
            "+                    <a href=\"#Issues\">Known Issues</a>\n", 
            "+                </li>\n", 
            "             </ul>\n", 
            "         </section>\n", 
            "         <section name=\"Introduction\" id=\"Introduction\">\n"
          ]
        }, 
        {
          "locn": "-293,6 +300,123", 
          "lines": [
            "                 </table>\n", 
            "                 <p><a href=\"#Contents\">[Back to top]</a></p>\n", 
            "             </subsection>\n", 
            "+            <subsection name=\"File Transport Sender (VFS Sender)\" id=\"Sender\">\n", 
            "+                <p>\n", 
            "+                    The file transport sender allows writing outgoing messages to local or remote\n", 
            "+                    files. To activate the file transport sender, simply uncomment the following\n", 
            "+                    transport sender configuration in the <strong>SYNAPSE_HOME/repository/conf/axis2.xml</strong>\n", 
            "+                    file.\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;transportSender name=\"vfs\" class=\"org.apache.synapse.transport.vfs.VFSTransportSender\"/&gt;</div>\n", 
            "+                <p>\n", 
            "+                    To send a message using the file transport, define a Synapse endpoint with an\n", 
            "+                    address that starts with the prefix 'vfs:'. The rest of the address should be a\n", 
            "+                    valid local or remote file URI. An example is shown below:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;endpoint&gt;\n", 
            "+    &lt;address uri=&quot;vfs:file:///var/spool/synapse/out&quot;/&gt;\n", 
            "+&lt;/endpoint&gt;</div>\n", 
            "+                <p>\n", 
            "+                    Some more example file URIs are listed below. Remember to prefix each\n", 
            "+                    URI with the string 'vfs:' when using these to define Synapse endpoints.\n", 
            "+                    Refer <a class=\"externalLink\" href=\"http://commons.apache.org/vfs/filesystems.html\">http://commons.apache.org/vfs/filesystems.html</a>\n", 
            "+                    for a complete list of Commons VFS supported protocols and their corresponding\n", 
            "+                    URI formats.\n", 
            "+                </p>\n", 
            "+                <ul>\n", 
            "+                    <li>\n", 
            "+                        <tt>file:///directory/filename.ext</tt>\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        <tt>file:////somehost/someshare/afile.txt</tt>\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        <tt>jar:../lib/classes.jar!/META-INF/manifest.mf</tt>\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        <tt>jar:zip:outer.zip!/nested.jar!/somedir</tt>\n", 
            "+                    </li>\n", 
            "+                    <li>\n", 
            "+                        <tt>ftp://myusername:mypassword@somehost/pub/downloads/somefile.tgz</tt>\n", 
            "+                    </li>\n", 
            "+                </ul>\n", 
            "+                <p>\n", 
            "+                    By default file locking is globally enabled for the file transport sender.\n", 
            "+                    This behavior can be overridden at the endpoint level by specifying\n", 
            "+                    <tt>transport.vfs.Locking</tt> as a URL query parameter with the appropriate value\n", 
            "+                    (enable/disable) on a given endpoint:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;endpoint&gt;\n", 
            "+    &lt;address uri=&quot;vfs:file:///var/spool/synapse/out?transport.vfs.Locking=disable&quot;/&gt;\n", 
            "+&lt;/endpoint&gt;</div>\n", 
            "+                <p>\n", 
            "+                    You may also change the global locking behavior by setting the <tt>transport.vfs.Locking</tt>\n", 
            "+                    parameter in the file transport sender configuration in axis2.xml file.\n", 
            "+                </p>\n", 
            "+                <p>\n", 
            "+                    When writing to remote file locations using a protocol such as FTP, you might\n", 
            "+                    want Synapse to communicate with the FTP server in the passive mode. To\n", 
            "+                    configure this behavior, simply add the query parameter <tt>vfs.passive</tt> to the\n", 
            "+                    endpoint address:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;endpoint&gt;\n", 
            "+    &lt;address uri=&quot;vfs:ftp://myusername:mypassword@somehost/pub/downloads/somefile.tgz?vfs.passive=true&quot;/&gt;\n", 
            "+&lt;/endpoint&gt;</div>\n", 
            "+                <p>\n", 
            "+                    It should be noted that by its nature, the file transport sender doesn't support\n", 
            "+                    synchronous responses and should only be invoked using the out-only message\n", 
            "+                    exchange pattern. In a Synapse mediation (sequence/proxy/API), this can be forced\n", 
            "+                    using the following mediator:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;property name=&quot;OUT_ONLY&quot; value=&quot;true&quot;/&gt;</div>\n", 
            "+                <p><a href=\"#Contents\">[Back to top]</a></p>\n", 
            "+            </subsection>\n", 
            "         </section>\n", 
            "+        <section name=\"Using SFTP\" id=\"SFTP\">\n", 
            "+            <p>\n", 
            "+                To avoid man-in-the-middle attacks, SSH clients will only connect to hosts with\n", 
            "+                a known host key. When connecting for the first time to an SSH server, a typical\n", 
            "+                command line SSH client would request confirmation from the user to add the\n", 
            "+                server and its fingerprint to the list of known hosts.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                The VFS transports supports SFTP through the\n", 
            "+                <a class=\"externalLink\" href=\"http://www.jcraft.com/jsch/\">JSch</a>\n", 
            "+                library and this library also requires a list of known hosts. Since Synapse is\n", 
            "+                not an interactive process, it can't request confirmation from the user and is\n", 
            "+                therefore unable to automatically add a host to the list. This implies that the\n", 
            "+                list of known hosts must be set up manually before the transport can connect.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                JSch loads the list of known hosts from a file called <tt>known_hosts</tt> in\n", 
            "+                the <tt>.ssh</tt> sub-directory of the user's home directory, i.e. <tt>$HOME/.ssh</tt>\n", 
            "+                in Unix and <tt>%HOMEPATH%\\.ssh</tt> in Windows. The location and format of this\n", 
            "+                file are compatible with the <a class=\"externalLink\" href=\"http://www.openssh.com/\">OpenSSH</a>\n", 
            "+                client.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                Since the file not only contains a list of host names but also the fingerprints\n", 
            "+                of their host keys, the easiest way to add a new host to that file is to simply\n", 
            "+                use the OpenSSH client to open an SSH session on the target host. The client will\n", 
            "+                then ask to add the credentials to the <tt>known_hosts</tt> file. Note that if\n", 
            "+                the SSH server is configured to only allow SFTP sessions, but no interactive\n", 
            "+                sessions, the connection will actually fail. Since this doesn't rollback the\n", 
            "+                change to the <tt>known_hosts</tt> file, this error can be ignored.\n", 
            "+            </p>\n", 
            "+        </section>\n", 
            "+        <section name=\"Known issues\" id=\"Issues\">\n", 
            "+            <p>\n", 
            "+                The VFS listener will start reading a file as soon as it appears in the configured\n", 
            "+                location. To avoid processing half written files, the creation of these files should\n", 
            "+                be made atomic. On most platforms this can be achieved by writing the data to a\n", 
            "+                temporary file and then moving the file to the target location. Note however that\n", 
            "+                a move operation is only atomic if the source and destination are on the same\n", 
            "+                physical file system. The location for the temporary file should be chosen with\n", 
            "+                that constraint in mind.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                It should also be noted that the VFS transport sender doesn't create files atomically.\n", 
            "+            </p>\n", 
            "+        </section>\n", 
            "     </body>\n", 
            " </document>\n", 
            "\\ No newline at end of file\n"
          ]
        }
      ], 
      "to": "java/modules/documentation/src/site/xdoc/userguide/transports/vfs.xml", 
      "from": "java/modules/documentation/src/site/xdoc/userguide/transports/vfs.xml"
    }
  ], 
  "id": "1515029"
}