{
  "when": "2013-07-21T04:40:00-04:00", 
  "message": "SYNAPSE-838: Adding the EJB sample.\n", 
  "who": "sadeep", 
  "changes": [
    {
      "chunks": [
        {
          "locn": "-0,0 +1,65", 
          "lines": [
            "+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n", 
            "+<!--\n", 
            "+  ~  Licensed to the Apache Software Foundation (ASF) under one\n", 
            "+  ~  or more contributor license agreements.  See the NOTICE file\n", 
            "+  ~  distributed with this work for additional information\n", 
            "+  ~  regarding copyright ownership.  The ASF licenses this file\n", 
            "+  ~  to you under the Apache License, Version 2.0 (the\n", 
            "+  ~  \"License\"); you may not use this file except in compliance\n", 
            "+  ~  with the License.  You may obtain a copy of the License at\n", 
            "+  ~ \n", 
            "+  ~   http://www.apache.org/licenses/LICENSE-2.0\n", 
            "+  ~\n", 
            "+  ~  Unless required by applicable law or agreed to in writing,\n", 
            "+  ~  software distributed under the License is distributed on an\n", 
            "+  ~   * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n", 
            "+  ~  KIND, either express or implied.  See the License for the\n", 
            "+  ~  specific language governing permissions and limitations\n", 
            "+  ~  under the License.\n", 
            "+  -->\n", 
            "+  \n", 
            "+<!-- Invoking remote EJB Stateless Session Beans from Synapse. -->\n", 
            "+<definitions xmlns=\"http://ws.apache.org/ns/synapse\">\n", 
            "+\n", 
            "+    <proxy name=\"StoreLocatorProxy\" transports=\"https http\" startOnLoad=\"true\" trace=\"disable\">\n", 
            "+        <target>\n", 
            "+        \n", 
            "+            <!-- First call StoreLocator#getClosestStore(), then call StoreRegistry#getStoreById() with the result. -->\n", 
            "+            <inSequence>\n", 
            "+                <bean action=\"CREATE\" class=\"samples.bean.Location\" var=\"loc\"/>\n", 
            "+                <bean action=\"SET_PROPERTY\" var=\"loc\" property=\"latitude\" value=\"{//m:latitude}\" xmlns:m=\"http://services.samples\"/>\n", 
            "+                <bean action=\"SET_PROPERTY\" var=\"loc\" property=\"longitude\" value=\"{//m:longitude}\" xmlns:m=\"http://services.samples\"/>\n", 
            "+                <ejb class=\"samples.ejb.StoreLocator\" beanstalk=\"demo\" method=\"getClosestStore\" target=\"loc_id\" jndiName=\"StoreLocatorBean/remote\">\n", 
            "+                    <args>\n", 
            "+                        <arg value=\"{get-property('loc')}\"/>\n", 
            "+                    </args>\n", 
            "+                </ejb>\n", 
            "+                <ejb class=\"samples.ejb.StoreRegistry\" beanstalk=\"demo\" method=\"getStoreById\" target=\"store\" jndiName=\"StoreRegistryBean/remote\">\n", 
            "+                    <args>\n", 
            "+                        <arg value=\"{get-property('loc_id')}\"/>\n", 
            "+                    </args>\n", 
            "+                </ejb>\n", 
            "+                <!-- Prepare the response. -->\n", 
            "+                <enrich>\n", 
            "+                    <source type=\"inline\" clone=\"true\">\n", 
            "+                        <getClosestStoreResponse xmlns=\"\">\n", 
            "+                            <store>\n", 
            "+                                <name>?</name>\n", 
            "+                                <address>?</address>\n", 
            "+                                <phone>?</phone>\n", 
            "+                            </store>\n", 
            "+                        </getClosestStoreResponse>\n", 
            "+                    </source>\n", 
            "+                    <target type=\"body\"/>\n", 
            "+                </enrich>\n", 
            "+                <bean action=\"GET_PROPERTY\" var=\"store\" property=\"name\" target=\"{//store/name/text()}\"/>\n", 
            "+                <bean action=\"GET_PROPERTY\" var=\"store\" property=\"address\" target=\"{//store/address/text()}\"/>\n", 
            "+                <bean action=\"GET_PROPERTY\" var=\"store\" property=\"phoneNo\" target=\"{//store/phone/text()}\"/>\n", 
            "+                <header name=\"To\" action=\"remove\"/>\n", 
            "+                <property name=\"RESPONSE\" value=\"true\"/>\n", 
            "+                <send/>\n", 
            "+            </inSequence>\n", 
            "+        </target>\n", 
            "+    </proxy>\n", 
            "+\n", 
            "+</definitions>\n"
          ]
        }
      ], 
      "to": "java/repository/conf/sample/synapse_sample_470.xml", 
      "from": "java/repository/conf/sample/synapse_sample_470.xml"
    }, 
    {
      "chunks": [
        {
          "locn": "-0,0 +1,75", 
          "lines": [
            "+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n", 
            "+<!--\n", 
            "+  ~  Licensed to the Apache Software Foundation (ASF) under one\n", 
            "+  ~  or more contributor license agreements.  See the NOTICE file\n", 
            "+  ~  distributed with this work for additional information\n", 
            "+  ~  regarding copyright ownership.  The ASF licenses this file\n", 
            "+  ~  to you under the Apache License, Version 2.0 (the\n", 
            "+  ~  \"License\"); you may not use this file except in compliance\n", 
            "+  ~  with the License.  You may obtain a copy of the License at\n", 
            "+  ~ \n", 
            "+  ~   http://www.apache.org/licenses/LICENSE-2.0\n", 
            "+  ~\n", 
            "+  ~  Unless required by applicable law or agreed to in writing,\n", 
            "+  ~  software distributed under the License is distributed on an\n", 
            "+  ~   * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n", 
            "+  ~  KIND, either express or implied.  See the License for the\n", 
            "+  ~  specific language governing permissions and limitations\n", 
            "+  ~  under the License.\n", 
            "+  -->\n", 
            "+  \n", 
            "+<!-- Invoking remote EJB Stateful Session Beans from Synapse. -->\n", 
            "+<definitions xmlns=\"http://ws.apache.org/ns/synapse\">\n", 
            "+\n", 
            "+    <proxy name=\"BuyAllProxy\" transports=\"https http\" startOnLoad=\"true\" trace=\"disable\">\n", 
            "+        <target>\n", 
            "+        \n", 
            "+            <!-- Iterate over all items in the request and call addItem() on the ShoppingCart EJB for each item. -->\n", 
            "+            <inSequence>\n", 
            "+                <property name=\"SESSION_ID\" expression=\"get-property('MessageID')\"/>\n", 
            "+                <iterate xmlns:m0=\"http://services.samples\" preservePayload=\"false\"\n", 
            "+                         expression=\"//m0:buyItems/m0:items/m0:item\">\n", 
            "+                    <target>\n", 
            "+                        <sequence>\n", 
            "+                        \n", 
            "+                            <!-- You might want to change the jndiName, depending on your EJB container. -->\n", 
            "+                            <ejb class=\"samples.ejb.ShoppingCart\" beanstalk=\"demo\" method=\"addItem\" sessionId=\"{get-property('SESSION_ID')}\" jndiName=\"ShoppingCartBean/remote\">\n", 
            "+                                <args>\n", 
            "+                                    <arg value=\"{//m:item//m:id}\" xmlns:m=\"http://services.samples\"/>\n", 
            "+                                    <arg value=\"{//m:item//m:quantity}\" xmlns:m=\"http://services.samples\"/>\n", 
            "+                                </args>\n", 
            "+                            </ejb>\n", 
            "+                            <sequence key=\"collector\"/>\n", 
            "+                        </sequence>\n", 
            "+                    </target>\n", 
            "+                </iterate>\n", 
            "+            </inSequence>\n", 
            "+        </target>\n", 
            "+    </proxy>\n", 
            "+\n", 
            "+    <!-- Prepare the response once all addItem() calls are finished. -->\n", 
            "+    <sequence name=\"collector\">\n", 
            "+        <aggregate>\n", 
            "+            <onComplete>\n", 
            "+                <ejb class=\"samples.ejb.ShoppingCart\" beanstalk=\"demo\" method=\"getItemCount\" sessionId=\"{get-property('SESSION_ID')}\" target=\"ITEM_COUNT\"/>\n", 
            "+                <ejb class=\"samples.ejb.ShoppingCart\" beanstalk=\"demo\" method=\"getTotal\" sessionId=\"{get-property('SESSION_ID')}\" target=\"TOTAL\" remove=\"true\"/>\n", 
            "+                <payloadFactory>\n", 
            "+                    <format>\n", 
            "+                        <buyAllResponse xmlns=\"\">\n", 
            "+                            <itemCount>$1</itemCount>\n", 
            "+                            <total>$2</total>\n", 
            "+                        </buyAllResponse>\n", 
            "+                    </format>\n", 
            "+                    <args>\n", 
            "+                        <arg expression=\"get-property('ITEM_COUNT')\"/>\n", 
            "+                        <arg expression=\"get-property('TOTAL')\"/>\n", 
            "+                    </args>\n", 
            "+                </payloadFactory>\n", 
            "+                <property name=\"RESPONSE\" value=\"true\"/>\n", 
            "+                <header name=\"To\" action=\"remove\"/>\n", 
            "+                <send/>\n", 
            "+            </onComplete>\n", 
            "+        </aggregate>\n", 
            "+    </sequence>\n", 
            "+\n", 
            "+</definitions>\n"
          ]
        }
      ], 
      "to": "java/repository/conf/sample/synapse_sample_471.xml", 
      "from": "java/repository/conf/sample/synapse_sample_471.xml"
    }
  ], 
  "id": "1505307"
}